<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>ElasticStack-12-Logstash篇之入门与运行机制 | Startshineye的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1.入门及架构简介1.1 Logstash介绍
1.数据收集处理引擎  
2.ETL工具  

1.2 架构简介 
1.左边是各种各样的数据源:文件、excle、http的service、数据库、自定义数据源2.右边是logstash支持的功能:Analysis(指标分析)、Archiving(归档)、es、Monitoring(监控)、Alerting(报警)
  
logstash分为3个阶段">
<meta property="og:type" content="article">
<meta property="og:title" content="ElasticStack-12-Logstash篇之入门与运行机制">
<meta property="og:url" content="https://github.com/startshineye/2019/09/21/ElasticStack-12-Logstash篇之入门与运行机制/index.html">
<meta property="og:site_name" content="Startshineye的博客">
<meta property="og:description" content="1.入门及架构简介1.1 Logstash介绍
1.数据收集处理引擎  
2.ETL工具  

1.2 架构简介 
1.左边是各种各样的数据源:文件、excle、http的service、数据库、自定义数据源2.右边是logstash支持的功能:Analysis(指标分析)、Archiving(归档)、es、Monitoring(监控)、Alerting(报警)
  
logstash分为3个阶段">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/70.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/71.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/72.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/73.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/74.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/75.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/76.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/77.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/78.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/79.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/80.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/81.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/82.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/83.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/84.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/85.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/86.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/87.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/88.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/89.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/90.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/91.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/92.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/93.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/94.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/95.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/96.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/97.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/98.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/99.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/100.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/101.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/102.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/103.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/104.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/105.png">
<meta property="og:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/106.png">
<meta property="og:updated_time" content="2019-09-25T10:24:33.172Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ElasticStack-12-Logstash篇之入门与运行机制">
<meta name="twitter:description" content="1.入门及架构简介1.1 Logstash介绍
1.数据收集处理引擎  
2.ETL工具  

1.2 架构简介 
1.左边是各种各样的数据源:文件、excle、http的service、数据库、自定义数据源2.右边是logstash支持的功能:Analysis(指标分析)、Archiving(归档)、es、Monitoring(监控)、Alerting(报警)
  
logstash分为3个阶段">
<meta name="twitter:image" content="https://raw.githubusercontent.com/startshineye/img/master/2019/09/70.png">
  
    <link rel="alternative" href="/atom.xml" title="Startshineye的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <script src="/style.js"></script>
  

</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			 <img src="https://raw.githubusercontent.com/startshineye/img/master/2017/king.jpg" class="js-avatar show">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Startshineye</a></h1>
		</hgroup>

		
		<p class="header-subtitle">淡泊明志，宁静致远</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/archives">所有文章</a></li>
	        
				<li><a href="/tags/随笔">随笔</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="2" href="javascript:void(0)">友链</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="3" href="javascript:void(0)">关于我</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/startshineye" title="github">github</a>
		        
					<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
		        
					<a class="rss" target="_blank" href="#" title="rss">rss</a>
		        
					<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
		        
					<a class="mail" target="_blank" href="#" title="mail">mail</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">Startshineye</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="https://raw.githubusercontent.com/startshineye/img/master/2017/king.jpg" class="js-avatar show">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Startshineye</h1>
			</hgroup>
			
			<p class="header-subtitle">淡泊明志，宁静致远</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/随笔">随笔</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/startshineye" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
			        
						<a class="mail" target="_blank" href="#" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        <article id="post-ElasticStack-12-Logstash篇之入门与运行机制" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ElasticStack-12-Logstash篇之入门与运行机制
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-入门及架构简介"><a href="#1-入门及架构简介" class="headerlink" title="1.入门及架构简介"></a>1.入门及架构简介</h3><h4 id="1-1-Logstash介绍"><a href="#1-1-Logstash介绍" class="headerlink" title="1.1 Logstash介绍"></a>1.1 Logstash介绍</h4><ol>
<li>1.数据收集处理引擎  </li>
<li>2.ETL工具  </li>
</ol>
<h4 id="1-2-架构简介"><a href="#1-2-架构简介" class="headerlink" title="1.2 架构简介"></a>1.2 架构简介</h4><p><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/70.png" alt=""> </p>
<p>1.左边是各种各样的数据源:文件、excle、http的service、数据库、自定义数据源<br>2.右边是logstash支持的功能:Analysis(指标分析)、Archiving(归档)、es、Monitoring(监控)、Alerting(报警)</p>
<p><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/71.png" alt="">  </p>
<p>logstash分为3个阶段:<br>1.Input:数据采集<br>2.Filter:数据解析/转换<br>3.数据输出  </p>
<p><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/72.png" alt=""><br>logstash处理流如下:<br>数据从标准输入流(stdin)进来、然后经过filter插件:(grok、date、geoip、useragent)、执行完之后进入output阶段、此时输出到elasticsearch   </p>
<h4 id="1-3-名词解析"><a href="#1-3-名词解析" class="headerlink" title="1.3 名词解析"></a>1.3 名词解析</h4><ol>
<li><p>1.Pipeline<br>-input -filter-output的3阶段处理流程<br>-队列管理(Pipeline中涉及到一个队列,自己写pipeline插件的话也需要会写pipeline生命周期的管理)<br>-插件生命周期  </p>
</li>
<li><p>2.Logstash Event<br>-内部流转的数据表现形式<br>-原始数据在input被转换为Event,在output event被转换为目标格式数据<br>-在配置文件中可以对Event中属性进行增删改查  </p>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/73.png" alt=""><br>原始数据从Input进来之后,会经过decode,将原始数据转换成Event、输出时候在Output中通过encode将Event转换你为Data。</p>
<p>我们将codec-decode加入后变成如下形式:<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/74.png" alt="">  </p>
<p>1.原始数据通过Input中的codec-decode把数据转换成Logstash Event、经过filter中各个plugin的处理后还是Logstash Event、再经过Output中的codec-encode之后转换为原始数据。  </p>
<p>简单的例子如下:<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/75.png" alt=""></p>
<p>以下标准数据流后使用codec-&gt;line(按照每一行切割数据、换行符切割)、filter为空、output中的codec-&gt;json(把每一个logstash Event转化为json对象)  </p>
<p>我们以以下输入:”foo\bar”为例。<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/76.png" alt=""><br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/77.png" alt="">  </p>
<p><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/78.png" alt="">  </p>
<h3 id="2-Event的生命周期"><a href="#2-Event的生命周期" class="headerlink" title="2.Event的生命周期"></a>2.Event的生命周期</h3><h4 id="2-1-整个架构"><a href="#2-1-整个架构" class="headerlink" title="2.1 整个架构"></a>2.1 整个架构</h4><p>接下来我们整体了解下:logstash的整个架构。<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/79.png" alt=""><br>1.1.每个input可以有哦多个的,每个input绑定了一个codec.<br>2.2.箭头”-&gt;”表示的是数据流向<br>3.3.通过input进来的数据经过codec后进行queue中,然后queue把数据分发到不同的pipeline中,pipeline由:Batcher、Filter、Output组成。<br>4.4.Batcher作用是批量从Queue中取数据(每次取多少数据是可以配置的)。<br>5.5.上面的架构是logstash经过很多次迭代后形成的架构。  </p>
<h4 id="2-2-一个logstash的整个生命历程-life"><a href="#2-2-一个logstash的整个生命历程-life" class="headerlink" title="2.2 一个logstash的整个生命历程(life)"></a>2.2 一个logstash的整个生命历程(life)</h4><ol>
<li>1.首先input会从web.log中收集数据(Line1,line2,..代表的是每一行数据)<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/80.png" alt="">  </li>
<li><p>2.Json Codec读取到line1数据之后会将其转换成Event<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/81.png" alt=""><br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/82.png" alt="">  </p>
</li>
<li><p>3.Event经过Queue后流转到不同的pipeline里面的batcher里面,经过时间推移,batcher里面缓存到越来越多的数据,数据达到阈值或者时间到了之后经过filter后经过output、最后输出到其他中间件,输出之后发送ACK给Queue。<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/83.png" alt=""><br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/84.png" alt="">  </p>
</li>
</ol>
<h3 id="3-Queue简介"><a href="#3-Queue简介" class="headerlink" title="3.Queue简介"></a>3.Queue简介</h3><h4 id="3-1-Queue分类"><a href="#3-1-Queue分类" class="headerlink" title="3.1 Queue分类"></a>3.1 Queue分类</h4><ol>
<li>1.In Memory<br>-无法处理进程Crash、机器宕机等情况,会导致数据丢失。  </li>
<li>2.Persistent Queue In Disk<br>-可处理进程Crash等情况,保证数据不丢失。<br>-保证数据至少消费一次。<br>-充当缓冲区,类似于kafaka消息队列，可以替代kafaka等消息队列的作用。  </li>
</ol>
<h4 id="3-2-Persistent-Queue容灾特性"><a href="#3-2-Persistent-Queue容灾特性" class="headerlink" title="3.2 Persistent Queue容灾特性"></a>3.2 Persistent Queue容灾特性</h4><ol>
<li>1.数据从Input后到达PQ(Persistent Queue)、然后数据会在DISK上一个备份、然后DISK通知PQ我已经收到这个数据了。并返回给Input、之后数据就会到Filter/Output、然后Output收到数据并推送出去之后发送消息给PQ(ack)、然后通知DISKs删除数据。<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/85.png" alt="">  </li>
</ol>
<h4 id="3-3-PQ性能分析"><a href="#3-3-PQ性能分析" class="headerlink" title="3.3 PQ性能分析"></a>3.3 PQ性能分析</h4><p><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/86.png" alt=""> </p>
<p>从上面可以知道,PQ比memory性能相差不大  </p>
<h4 id="3-4-PQ基本配置"><a href="#3-4-PQ基本配置" class="headerlink" title="3.4 PQ基本配置"></a>3.4 PQ基本配置</h4><p>我们可以设置queue的类型和数据存储。  </p>
<ol>
<li>1.queue.type:persisted  </li>
<li>2.queue.max_bytest:4gb<br>-队列存储最大数据量  </li>
</ol>
<h3 id="4-线程简介"><a href="#4-线程简介" class="headerlink" title="4.线程简介"></a>4.线程简介</h3><p>在之前的架构中、logstash有哪些线程<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/87.png" alt="">  </p>
<p>我们一般进行logstash调优时候一般主要是对线程数进行调节。</p>
<h4 id="4-1-线程相关配置"><a href="#4-1-线程相关配置" class="headerlink" title="4.1 线程相关配置"></a>4.1 线程相关配置</h4><ol>
<li><p>1.pipeline.workers | -w<br>-pipeline线程数,即filter_output的处理线程数,默认是cpu核数。  </p>
</li>
<li><p>2.pipeline.batch.size | -b<br>-Batcher一次批量获取的待处理文档数,默认是125,可以根据输出进行调整,越大会占用越多的heap空间,可以通过jvm.options调整  </p>
</li>
<li>3.pipeline.batch.delay | -u<br>-Batcher等待的时长,单位为ms,默认是50ms  (在指定时间内还没有达到batcher的容联,也会把数据送给Filter/Output处理)  </li>
</ol>
<p>我们通过软件:VisualVM来查看JVM相关信息。<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/88.png" alt="">  </p>
<p><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/89.png" alt=""><br>我们可以查看其线程数目:<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/90.png" alt=""><br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/91.png" alt="">  </p>
<h3 id="5-配置简介"><a href="#5-配置简介" class="headerlink" title="5.配置简介"></a>5.配置简介</h3><p>logstash配置文件分为两种，1种是logstash设置相关的配置文件、还有1种是pipeline配置文件。  </p>
<ol>
<li><p>1.logstash设置相关的配置文件(在conf文件夹中,setting files)<br>-logstash.yml:logstash相关配置,比如node.name、path.data、pipeline.workers、queue.type等、这其中的配置可以被命令行参数中的相关参数覆盖<br>-jvm.options:修改jvm的相关参数,比如修改heap size等。  </p>
</li>
<li><p>2.pipeline配置文件<br>-定义数据处理流程的文件,以.conf结尾。  </p>
</li>
</ol>
<h4 id="5-1-logstash-yml"><a href="#5-1-logstash-yml" class="headerlink" title="5.1 logstash.yml"></a>5.1 logstash.yml</h4><ol>
<li>1.使用yaml语法、支持如下两种形式:<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/92.png" alt="">  </li>
</ol>
<h4 id="5-2-logstash-yml-常用配置项"><a href="#5-2-logstash-yml-常用配置项" class="headerlink" title="5.2 logstash.yml 常用配置项"></a>5.2 logstash.yml 常用配置项</h4><ol>
<li><p>1.node.name<br>-节点名,便于识别，建议定义成有实际意义的    </p>
</li>
<li><p>2.path.data<br>-持久化存储数据的文件夹,默认是logstash home目录下的data  </p>
</li>
<li><p>3.path.config<br>-设定pipeline配置文件的目录  </p>
</li>
<li><p>4.path.log<br>-设定pipeline日志文件的目录  </p>
</li>
<li><p>5.pipeline.workers<br>-设定pipeline的线程数(filter+output),优化的常用项。  </p>
</li>
<li><p>6.pipeline.batcher.size/delay<br>-设定批量处理数据的数目和延迟  </p>
</li>
<li><p>7.queue.type<br>-设定队列类型,默认是memory  </p>
</li>
<li><p>8.queue.max_bytes<br>-队列总容量,默认是1g  </p>
</li>
</ol>
<h4 id="5-3-logstash命令行配置项"><a href="#5-3-logstash命令行配置项" class="headerlink" title="5.3 logstash命令行配置项"></a>5.3 logstash命令行配置项</h4><p><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/93.png" alt="">  </p>
<p>-t用于校验：<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/94.png" alt=""></p>
<p><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/95.png" alt="">  </p>
<p><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/96.png" alt="">  </p>
<h3 id="6-多实例运行方式"><a href="#6-多实例运行方式" class="headerlink" title="6.多实例运行方式"></a>6.多实例运行方式</h3><p>接下来我们看一下在一台机器上运行多个logstash实例。挂件配置就是path.settings,让logstash加载不同的logstash配置路径。   </p>
<ol>
<li>1.bin/logstash –path.settings instance1   </li>
<li>2.bin/logstash –path.settings instance2  </li>
<li>3.不同的instance中修改logstash.yml,自定义path.data，确保其不相同即可。(注意:不同的实例一定要配置不同的path.data,因为一个path.data实例只能被一个实例使用，如果logstash发现此目录已经被其他使用将会启用失败)  </li>
</ol>
<p>实际操作如下：我们进入logstash的config文件夹，里面有如下配置：里面有5个和settingfiles相关文件。<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/97.png" alt=""> </p>
<p>比如我们需要启用实例2:instance2  </p>
<ol>
<li>1.赋值一份config文件  </li>
<li><p>2.修改配置文件<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/98.png" alt="">  </p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">    </div><div class="line">node.name test2  </div><div class="line">path.data instance2 //没有跟绝对路径,则会在logstash的hone目录创建此目录  </div><div class="line">path.config imooc/codec.conf //设置pipeline的路径</div></pre></td></tr></table></figure>
</li>
<li><p>3.查看pipeline的配置如下:<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/99.png" alt="">  </p>
</li>
<li><p>4.启动实例后的结果:<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/100.png" alt=""></p>
</li>
</ol>
<h3 id="7-pipeline配置简介"><a href="#7-pipeline配置简介" class="headerlink" title="7.pipeline配置简介"></a>7.pipeline配置简介</h3><p>接下来,我们看一下pipeline的配置。pipeline是用来配置input、filter和output的插件,框架如下所示:<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/101.png" alt=""><br>在以上大括号里面写具体的插件。  </p>
<h4 id="7-1-pipeline配置语法"><a href="#7-1-pipeline配置语法" class="headerlink" title="7.1 pipeline配置语法"></a>7.1 pipeline配置语法</h4><p>logstash的pipeline的配置文件用的是自己的一套语法，以下是在配置中可以设置的数值类型:  </p>
<ol>
<li>1.布尔型Boolean<br>-isFailed=&gt;true(比如把isFailed设置为true)  </li>
<li>2.数值类型Number<br>-port=&gt;33  </li>
<li>3.字符串类型String<br>-name=&gt;”Hello world”  </li>
<li><p>4.数组Array/List<br>-users=&gt;[{id=&gt;1,name=&gt;bbb},{id=&gt;2,name=&gt;jane}]<br>-path=&gt;[“/var/log/messages”,”/var/log/*.log”]  </p>
</li>
<li><p>5.哈希类型Hash<br>-match=&gt;{<br>“field1”=&gt;”value1”<br>“field2”=&gt;”value2”<br>}  </p>
</li>
<li><p>6.注释<br>-井号<br>-# this is a comment  </p>
</li>
<li><p>7.在配置中可以应用Logstash Event(本身就是一个java Object)的属性(字段)，z主要有如下两种方式:<br>-直接应用字段值<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/102.png" alt=""><br>-在字符串中以sprintf方式引用<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/103.png" alt="">  </p>
</li>
<li><p>8.支持条件判断语法,从而扩展了配置的多样性,主要格式如下:<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/104.png" alt=""><br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/105.png" alt=""><br>实例如下:<br><img src="https://raw.githubusercontent.com/startshineye/img/master/2019/09/106.png" alt="">  </p>
</li>
</ol>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2019/09/21/ElasticStack-12-Logstash篇之入门与运行机制/" class="archive-article-date">
  	<time datetime="2019-09-21T13:06:28.000Z" itemprop="datePublished"><i class="icon-clock"></i>2019-09-21</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ElasticStack/">ElasticStack</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
  
    <a href="/2019/09/14/acdgate-1-websocket404/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">acdgate-1-websocket404</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>




<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">Share to: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
	    <a class="jiathis_button_twitter"></a>
	    <a class="jiathis_button_plus"></a> 
	    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>




<div class="share_addthis share_jia">
  <div class="sharing addthis_toolbox share">
  	<span class="jiathis_txt">Share to: &nbsp; </span>
    <a class="addthis_button_facebook_like"></a>
    <a class="addthis_button_tweet"></a>
    <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-560c64c35486b3d4" async="async"></script>
</div>




<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="ElasticStack-12-Logstash篇之入门与运行机制" data-title="ElasticStack-12-Logstash篇之入门与运行机制" data-url="https://github.com/startshineye/2019/09/21/ElasticStack-12-Logstash篇之入门与运行机制/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>





      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2019 Startshineye
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">标签</span><i class="icon-price-tags"></i></li>
    
    
      <li data-hook="tools-section-friends"><span class="text">友链</span><i class="icon-link"></i></li>
    
    
      <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				<a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/CTI/" style="font-size: 11.05px;">CTI</a> <a href="/tags/Cookie/" style="font-size: 10.53px;">Cookie</a> <a href="/tags/DevelopmentSkills/" style="font-size: 10px;">DevelopmentSkills</a> <a href="/tags/Easyui/" style="font-size: 10px;">Easyui</a> <a href="/tags/ElasticStack/" style="font-size: 14.74px;">ElasticStack</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/Http/" style="font-size: 10px;">Http</a> <a href="/tags/IE问题/" style="font-size: 10px;">IE问题</a> <a href="/tags/JDK/" style="font-size: 10px;">JDK</a> <a href="/tags/JSP/" style="font-size: 10px;">JSP</a> <a href="/tags/JVM/" style="font-size: 12.11px;">JVM</a> <a href="/tags/JavaSE/" style="font-size: 15.79px;">JavaSE</a> <a href="/tags/Jeecg/" style="font-size: 11.58px;">Jeecg</a> <a href="/tags/Maven/" style="font-size: 10px;">Maven</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/Myeclipse/" style="font-size: 14.21px;">Myeclipse</a> <a href="/tags/Netty/" style="font-size: 16.84px;">Netty</a> <a href="/tags/Node-js/" style="font-size: 10px;">Node.js</a> <a href="/tags/Oracle/" style="font-size: 16.84px;">Oracle</a> <a href="/tags/Redis/" style="font-size: 12.11px;">Redis</a> <a href="/tags/Servlet/" style="font-size: 11.58px;">Servlet</a> <a href="/tags/Spring/" style="font-size: 10.53px;">Spring</a> <a href="/tags/Spring-Boot/" style="font-size: 10px;">Spring Boot</a> <a href="/tags/SpringBoot/" style="font-size: 19.47px;">SpringBoot</a> <a href="/tags/SpringCloud/" style="font-size: 12.11px;">SpringCloud</a> <a href="/tags/SpringMVC/" style="font-size: 11.05px;">SpringMVC</a> <a href="/tags/Tomcat/" style="font-size: 10px;">Tomcat</a> <a href="/tags/Vue/" style="font-size: 18.95px;">Vue</a> <a href="/tags/Vue-js-前端开发-快速入门与专业应用/" style="font-size: 17.37px;">Vue.js+前端开发+快速入门与专业应用</a> <a href="/tags/Weblogic/" style="font-size: 12.11px;">Weblogic</a> <a href="/tags/Websocket/" style="font-size: 10.53px;">Websocket</a> <a href="/tags/Work-Problem/" style="font-size: 10px;">Work-Problem</a> <a href="/tags/acdgate/" style="font-size: 10px;">acdgate</a> <a href="/tags/bg/" style="font-size: 10px;">bg</a> <a href="/tags/c/" style="font-size: 10.53px;">c</a> <a href="/tags/crawler/" style="font-size: 17.89px;">crawler</a> <a href="/tags/dubbo/" style="font-size: 10px;">dubbo</a> <a href="/tags/easyui/" style="font-size: 10px;">easyui</a> <a href="/tags/freeswitch/" style="font-size: 10px;">freeswitch</a> <a href="/tags/hibernate/" style="font-size: 10.53px;">hibernate</a> <a href="/tags/html-css/" style="font-size: 10.53px;">html+css</a> <a href="/tags/html-css/" style="font-size: 15.79px;">html-css</a> <a href="/tags/html-ss/" style="font-size: 10px;">html-ss</a> <a href="/tags/im/" style="font-size: 13.68px;">im</a> <a href="/tags/ipcc/" style="font-size: 10.53px;">ipcc</a> <a href="/tags/jQuery/" style="font-size: 12.11px;">jQuery</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/java-String/" style="font-size: 10px;">java String</a> <a href="/tags/javaSE/" style="font-size: 10.53px;">javaSE</a> <a href="/tags/javaWeb/" style="font-size: 10px;">javaWeb</a> <a href="/tags/javascript/" style="font-size: 11.05px;">javascript</a> <a href="/tags/java并发编程/" style="font-size: 11.58px;">java并发编程</a> <a href="/tags/java集合/" style="font-size: 10.53px;">java集合</a> <a href="/tags/junit测试/" style="font-size: 10px;">junit测试</a> <a href="/tags/life/" style="font-size: 10px;">life</a> <a href="/tags/linux/" style="font-size: 16.84px;">linux</a> <a href="/tags/log4j/" style="font-size: 11.58px;">log4j</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/netty/" style="font-size: 11.58px;">netty</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/nodeJs/" style="font-size: 10px;">nodeJs</a> <a href="/tags/redis/" style="font-size: 12.63px;">redis</a> <a href="/tags/servlet/" style="font-size: 10px;">servlet</a> <a href="/tags/shiro/" style="font-size: 12.63px;">shiro</a> <a href="/tags/sockJs/" style="font-size: 10px;">sockJs</a> <a href="/tags/socket网络编程/" style="font-size: 10.53px;">socket网络编程</a> <a href="/tags/struts1/" style="font-size: 11.05px;">struts1</a> <a href="/tags/vue/" style="font-size: 10.53px;">vue</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/weblogic/" style="font-size: 11.05px;">weblogic</a> <a href="/tags/websocket/" style="font-size: 16.32px;">websocket</a> <a href="/tags/work/" style="font-size: 15.26px;">work</a> <a href="/tags/zyzx/" style="font-size: 18.42px;">zyzx</a> <a href="/tags/代理/" style="font-size: 11.58px;">代理</a> <a href="/tags/前端/" style="font-size: 10.53px;">前端</a> <a href="/tags/动手写一个MVC/" style="font-size: 12.11px;">动手写一个MVC</a> <a href="/tags/反射/" style="font-size: 16.32px;">反射</a> <a href="/tags/异常/" style="font-size: 10px;">异常</a> <a href="/tags/微博/" style="font-size: 10px;">微博</a> <a href="/tags/文件读取/" style="font-size: 10px;">文件读取</a> <a href="/tags/泛型/" style="font-size: 13.16px;">泛型</a> <a href="/tags/注解/" style="font-size: 11.05px;">注解</a> <a href="/tags/类加载器/" style="font-size: 13.16px;">类加载器</a> <a href="/tags/线程/" style="font-size: 10px;">线程</a> <a href="/tags/自己写一个apache服务器/" style="font-size: 16.84px;">自己写一个apache服务器</a> <a href="/tags/转载/" style="font-size: 12.11px;">转载</a> <a href="/tags/集合/" style="font-size: 12.11px;">集合</a>
    			</div>
    	</section>
    

    
    	<section class="tools-section tools-section-friends">
  		
  			<div class="friends-wrap" id="js-friends">
  			
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.baidu.com/">baidu</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jd.com/">jd</a>
  	        
  	        </div>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">毕业于&lt;br&gt;相信技术可以改变人与人之间的生活&lt;br&gt;码农一枚</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>